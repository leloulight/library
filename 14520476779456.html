<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  Node.js 命令行程序实例 - 小土刀的笔记
  
  </title>
 <meta name="description" content="">
 <link href="atom.xml" rel="alternate" title="小土刀的笔记" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />

    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>

<div id="header">
    <h1><a href="index.html">小土刀的笔记</a></h1>
</div>

</nav>
        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; 小土刀的笔记</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
      <li><a href="index.html">Home</a></li>
      
        <li class="divider"></li>
        <li><label>清单</label></li>

          
            <li><a title="好问题收集" href="14520379720179.html">好问题收集</a></li>
          
            <li><a title="书单合集" href="14520379720136.html">书单合集</a></li>
          
            <li><a title="日志列表" href="14520379720098.html">日志列表</a></li>
          
            <li><a title="玩物列表" href="14520379720223.html">玩物列表</a></li>
          

      
        <li class="divider"></li>
        <li><label>计算机学科经典</label></li>

          
            <li><a title="大教堂与集市" href="14520876353363.html">大教堂与集市</a></li>
          
            <li><a title="深入理解计算机系统" href="14520855371865.html">深入理解计算机系统</a></li>
          
            <li><a title="程序员的思维修炼" href="14520875018555.html">程序员的思维修炼</a></li>
          
            <li><a title="程序员修炼之道" href="14520874386531.html">程序员修炼之道</a></li>
          
            <li><a title="高效程序员的45个习惯" href="14520878121031.html">高效程序员的45个习惯</a></li>
          
            <li><a title="代码大全" href="14520855371782.html">代码大全</a></li>
          
            <li><a title="编写可读代码的艺术" href="14520874726715.html">编写可读代码的艺术</a></li>
          
            <li><a title="移动应用UI设计模式" href="14520886280669.html">移动应用UI设计模式</a></li>
          
            <li><a title="启示录：打造用户喜爱的产品" href="14520907410466.html">启示录：打造用户喜爱的产品</a></li>
          
            <li><a title="亲爱的界面：让用户乐于使用、爱不释手" href="14520885573483.html">亲爱的界面：让用户乐于使用、爱不释手</a></li>
          
            <li><a title="简约之美：软件设计之道" href="14520879229686.html">简约之美：软件设计之道</a></li>
          
            <li><a title="简单之美：软件开发实践者的思考" href="14520878623936.html">简单之美：软件开发实践者的思考</a></li>
          
            <li><a title="构建之法：现代软件工程" href="14520880342127.html">构建之法：现代软件工程</a></li>
          
            <li><a title="软件项目成功之道" href="14520883368873.html">软件项目成功之道</a></li>
          

      
        <li class="divider"></li>
        <li><label>工具</label></li>

          
            <li><a title="Mac 指南" href="14520959875185.html">Mac 指南</a></li>
          
            <li><a title="Bash 指南" href="14520940884566.html">Bash 指南</a></li>
          
            <li><a title="Hexo 指南" href="14520953748408.html">Hexo 指南</a></li>
          
            <li><a title="VS Code 指南" href="14520964818956.html">VS Code 指南</a></li>
          
            <li><a title="Homebrew 指南" href="14520954251052.html">Homebrew 指南</a></li>
          
            <li><a title="Pandoc 指南" href="14520962259349.html">Pandoc 指南</a></li>
          
            <li><a title="Vim 指南" href="14520964365928.html">Vim 指南</a></li>
          
            <li><a title="Sublime 指南" href="14520965272426.html">Sublime 指南</a></li>
          
            <li><a title="Latex 指南" href="14520955052445.html">Latex 指南</a></li>
          
            <li><a title="Git 指南" href="14520951022304.html">Git 指南</a></li>
          
            <li><a title="Github 生活指南" href="14520951022388.html">Github 生活指南</a></li>
          
            <li><a title="iTerm2 指南" href="14520954757815.html">iTerm2 指南</a></li>
          
            <li><a title="Ubuntu 指南" href="14520961679182.html">Ubuntu 指南</a></li>
          
            <li><a title="谷歌搜索技巧" href="14520951022464.html">谷歌搜索技巧</a></li>
          
            <li><a title="Make 指南" href="14520961098604.html">Make 指南</a></li>
          
            <li><a title="GCC 简易指南" href="14520948089088.html">GCC 简易指南</a></li>
          
            <li><a title="fish shell 指南" href="14520943310829.html">fish shell 指南</a></li>
          
            <li><a title="Gradle 指南" href="14520951022555.html">Gradle 指南</a></li>
          

      
        <li class="divider"></li>
        <li><label>编程语言</label></li>

          
            <li><a title="如何选择编程语言" href="14521020035250.html">如何选择编程语言</a></li>
          
            <li><a title="Matlab 指南" href="14521020962952.html">Matlab 指南</a></li>
          
            <li><a title="OpenMP 入门指南" href="14521021178707.html">OpenMP 入门指南</a></li>
          
            <li><a title="Javascript 学习指南" href="14521020732534.html">Javascript 学习指南</a></li>
          
            <li><a title="C++ 学习笔记" href="14520969294593.html">C++ 学习笔记</a></li>
          
            <li><a title="SQL 入门指南" href="14521021831775.html">SQL 入门指南</a></li>
          
            <li><a title="CUDA架构" href="14521020248399.html">CUDA架构</a></li>
          

      
        <li class="divider"></li>
        <li><label>Research</label></li>

          
            <li><a title="知识图谱沉思录" href="14520583101537.html">知识图谱沉思录</a></li>
          
            <li><a title="计算机视觉沉思录" href="14520483585854.html">计算机视觉沉思录</a></li>
          
            <li><a title="推荐系统沉思录" href="14520495721664.html">推荐系统沉思录</a></li>
          
            <li><a title="数据分析沉思录" href="14520494829635.html">数据分析沉思录</a></li>
          
            <li><a title="机器学习沉思录" href="14520493984651.html">机器学习沉思录</a></li>
          
            <li><a title="3D 打印沉思录" href="14520902603411.html">3D 打印沉思录</a></li>
          
            <li><a title="HMM 指南" href="14520495021796.html">HMM 指南</a></li>
          
            <li><a title="EM / GMM 指南" href="14520494287936.html">EM / GMM 指南</a></li>
          

      
        <li class="divider"></li>
        <li><label>iOS</label></li>

          
            <li><a title="iOS 学习路径" href="14520467690026.html">iOS 学习路径</a></li>
          
            <li><a title="iOS 面试相关" href="14520467689968.html">iOS 面试相关</a></li>
          

      
        <li class="divider"></li>
        <li><label>Android</label></li>

          
            <li><a title="Android Studio 指南" href="14520922857884.html">Android Studio 指南</a></li>
          
            <li><a title="Google Map V2 使用指南" href="14520474070782.html">Google Map V2 使用指南</a></li>
          
            <li><a title="ActionBar 使用指南" href="14520474070736.html">ActionBar 使用指南</a></li>
          

      
        <li class="divider"></li>
        <li><label>Web</label></li>

          
            <li><a title="网络协议指南" href="14520476779491.html">网络协议指南</a></li>
          
            <li><a title="Node.js 命令行程序实例" href="14520476779456.html">Node.js 命令行程序实例</a></li>
          
            <li><a title="Flask Study Note" href="14520476779406.html">Flask Study Note</a></li>
          

      
        <li class="divider"></li>
        <li><label>关于</label></li>

          
            <li><a title="版权声明" href="14520576386063.html">版权声明</a></li>
          

      
      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>

        <section id="main-content" role="main" class="scroll-container">

          <div class="row">
            <div class="large-3 medium-3 columns">
              <div class="hide-for-small">
                <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">

                    
                      <li class="side-title"><span>清单</span></li>
                        
                          <li><a title="好问题收集" href="14520379720179.html">好问题收集</a></li>
                        
                          <li><a title="书单合集" href="14520379720136.html">书单合集</a></li>
                        
                          <li><a title="日志列表" href="14520379720098.html">日志列表</a></li>
                        
                          <li><a title="玩物列表" href="14520379720223.html">玩物列表</a></li>
                        

                    
                      <li class="side-title"><span>计算机学科经典</span></li>
                        
                          <li><a title="大教堂与集市" href="14520876353363.html">大教堂与集市</a></li>
                        
                          <li><a title="深入理解计算机系统" href="14520855371865.html">深入理解计算机系统</a></li>
                        
                          <li><a title="程序员的思维修炼" href="14520875018555.html">程序员的思维修炼</a></li>
                        
                          <li><a title="程序员修炼之道" href="14520874386531.html">程序员修炼之道</a></li>
                        
                          <li><a title="高效程序员的45个习惯" href="14520878121031.html">高效程序员的45个习惯</a></li>
                        
                          <li><a title="代码大全" href="14520855371782.html">代码大全</a></li>
                        
                          <li><a title="编写可读代码的艺术" href="14520874726715.html">编写可读代码的艺术</a></li>
                        
                          <li><a title="移动应用UI设计模式" href="14520886280669.html">移动应用UI设计模式</a></li>
                        
                          <li><a title="启示录：打造用户喜爱的产品" href="14520907410466.html">启示录：打造用户喜爱的产品</a></li>
                        
                          <li><a title="亲爱的界面：让用户乐于使用、爱不释手" href="14520885573483.html">亲爱的界面：让用户乐于使用、爱不释手</a></li>
                        
                          <li><a title="简约之美：软件设计之道" href="14520879229686.html">简约之美：软件设计之道</a></li>
                        
                          <li><a title="简单之美：软件开发实践者的思考" href="14520878623936.html">简单之美：软件开发实践者的思考</a></li>
                        
                          <li><a title="构建之法：现代软件工程" href="14520880342127.html">构建之法：现代软件工程</a></li>
                        
                          <li><a title="软件项目成功之道" href="14520883368873.html">软件项目成功之道</a></li>
                        

                    
                      <li class="side-title"><span>工具</span></li>
                        
                          <li><a title="Mac 指南" href="14520959875185.html">Mac 指南</a></li>
                        
                          <li><a title="Bash 指南" href="14520940884566.html">Bash 指南</a></li>
                        
                          <li><a title="Hexo 指南" href="14520953748408.html">Hexo 指南</a></li>
                        
                          <li><a title="VS Code 指南" href="14520964818956.html">VS Code 指南</a></li>
                        
                          <li><a title="Homebrew 指南" href="14520954251052.html">Homebrew 指南</a></li>
                        
                          <li><a title="Pandoc 指南" href="14520962259349.html">Pandoc 指南</a></li>
                        
                          <li><a title="Vim 指南" href="14520964365928.html">Vim 指南</a></li>
                        
                          <li><a title="Sublime 指南" href="14520965272426.html">Sublime 指南</a></li>
                        
                          <li><a title="Latex 指南" href="14520955052445.html">Latex 指南</a></li>
                        
                          <li><a title="Git 指南" href="14520951022304.html">Git 指南</a></li>
                        
                          <li><a title="Github 生活指南" href="14520951022388.html">Github 生活指南</a></li>
                        
                          <li><a title="iTerm2 指南" href="14520954757815.html">iTerm2 指南</a></li>
                        
                          <li><a title="Ubuntu 指南" href="14520961679182.html">Ubuntu 指南</a></li>
                        
                          <li><a title="谷歌搜索技巧" href="14520951022464.html">谷歌搜索技巧</a></li>
                        
                          <li><a title="Make 指南" href="14520961098604.html">Make 指南</a></li>
                        
                          <li><a title="GCC 简易指南" href="14520948089088.html">GCC 简易指南</a></li>
                        
                          <li><a title="fish shell 指南" href="14520943310829.html">fish shell 指南</a></li>
                        
                          <li><a title="Gradle 指南" href="14520951022555.html">Gradle 指南</a></li>
                        

                    
                      <li class="side-title"><span>编程语言</span></li>
                        
                          <li><a title="如何选择编程语言" href="14521020035250.html">如何选择编程语言</a></li>
                        
                          <li><a title="Matlab 指南" href="14521020962952.html">Matlab 指南</a></li>
                        
                          <li><a title="OpenMP 入门指南" href="14521021178707.html">OpenMP 入门指南</a></li>
                        
                          <li><a title="Javascript 学习指南" href="14521020732534.html">Javascript 学习指南</a></li>
                        
                          <li><a title="C++ 学习笔记" href="14520969294593.html">C++ 学习笔记</a></li>
                        
                          <li><a title="SQL 入门指南" href="14521021831775.html">SQL 入门指南</a></li>
                        
                          <li><a title="CUDA架构" href="14521020248399.html">CUDA架构</a></li>
                        

                    
                      <li class="side-title"><span>Research</span></li>
                        
                          <li><a title="知识图谱沉思录" href="14520583101537.html">知识图谱沉思录</a></li>
                        
                          <li><a title="计算机视觉沉思录" href="14520483585854.html">计算机视觉沉思录</a></li>
                        
                          <li><a title="推荐系统沉思录" href="14520495721664.html">推荐系统沉思录</a></li>
                        
                          <li><a title="数据分析沉思录" href="14520494829635.html">数据分析沉思录</a></li>
                        
                          <li><a title="机器学习沉思录" href="14520493984651.html">机器学习沉思录</a></li>
                        
                          <li><a title="3D 打印沉思录" href="14520902603411.html">3D 打印沉思录</a></li>
                        
                          <li><a title="HMM 指南" href="14520495021796.html">HMM 指南</a></li>
                        
                          <li><a title="EM / GMM 指南" href="14520494287936.html">EM / GMM 指南</a></li>
                        

                    
                      <li class="side-title"><span>iOS</span></li>
                        
                          <li><a title="iOS 学习路径" href="14520467690026.html">iOS 学习路径</a></li>
                        
                          <li><a title="iOS 面试相关" href="14520467689968.html">iOS 面试相关</a></li>
                        

                    
                      <li class="side-title"><span>Android</span></li>
                        
                          <li><a title="Android Studio 指南" href="14520922857884.html">Android Studio 指南</a></li>
                        
                          <li><a title="Google Map V2 使用指南" href="14520474070782.html">Google Map V2 使用指南</a></li>
                        
                          <li><a title="ActionBar 使用指南" href="14520474070736.html">ActionBar 使用指南</a></li>
                        

                    
                      <li class="side-title"><span>Web</span></li>
                        
                          <li><a title="网络协议指南" href="14520476779491.html">网络协议指南</a></li>
                        
                          <li><a title="Node.js 命令行程序实例" href="14520476779456.html">Node.js 命令行程序实例</a></li>
                        
                          <li><a title="Flask Study Note" href="14520476779406.html">Flask Study Note</a></li>
                        

                    
                      <li class="side-title"><span>关于</span></li>
                        
                          <li><a title="版权声明" href="14520576386063.html">版权声明</a></li>
                        

                    
                  </ul>
                </nav>
                </div>
              </div>
            </div>
            <div class="large-9 medium-9 columns">

 <div class="markdown-body">
<h1>Node.js 命令行程序实例</h1>

<p>这个学期 Coding Bootcamp 最后一个作业是用 Node.js 做一个小程序，正好借此机会学习一下 Node.js。这个教程主要是关于如何用 Node.js 做命令行程序的，涉及服务器和 web 的部分基本上是没有的。</p>

<h2 id="toc_0">Node.js 基本介绍</h2>

<p>简单的说 Node.js 就是运行在服务端的 JavaScript。</p>

<ul>
<li>Node.js 是一个基于Chrome JavaScript 运行时建立的一个平台。</li>
<li>Node.js是一个事件驱动I/O服务端 JavaScript 环境，基于 Google 的V8 引擎，V8 引擎执行 Javascript 的速度非常快，性能非常好。</li>
</ul>

<p>换个角度来看，JavaScript 是脚本语言，脚本语言都需要一个解析器才能运行。对于写在 HTML 页面里的 JavaScript，浏览器充当了解析器的角色。而对于需要独立运行的 JavaScript，Node.js 就是一个解析器。</p>

<p>Node.js 的作者说，他创造 Node.js 的目的是为了实现高性能 Web 服务器，他首先看重的是事件机制和异步IO模型的优越性，而不是 JavaScript。但是他需要选择一种编程语言实现他的想法，这种编程语言不能自带IO功能，并且需要能良好支持事件机制。JavaScript 没有自带IO功能，天生就用于处理浏览器中的 DOM 事件，并且拥有一大群程序员，因此就成为了天然的选择。</p>

<p>开发之前的准备工作这里不赘述，在<a href="https://nodejs.org/en/">官网</a>上有详细的文档</p>

<p>唯一需要提的是最好安装一个 <a href="https://github.com/creationix/nvm">NVM</a>。NVM 的全称是 Node Version Manager，之所以需要这个工具，是因为 Node.js 的各种特性都没有稳定下来，所以我们经常由于老项目或尝新的原因，需要切换各种版本。</p>

<p>安装也很简单</p>

<p><code>curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.25.2/install.sh | bash</code></p>

<p>装好之后在终端中输入 <code>$ node</code>，REPL(read–eval–print loop) 应该就出来了，那我们就成功了。</p>

<h2 id="toc_1">任务介绍</h2>

<p>既然是实例教程，我们需要有一个例子，这里我们要做的事情有四个</p>

<ol>
<li>读入一个<a href="http://www.gutenberg.org/cache/epub/45/pg45.txt">文本文件</a></li>
<li>根据读入的内容进行一些数据计算

<ul>
<li>词数</li>
<li>行数</li>
<li>列出所有的词以及对应的出现次数，降序排列</li>
<li>出现次数最多的十个 trigram</li>
<li>出现次数最多的 trigram 与之后的十个出现次数最多的 trigram 的编辑距离，列出比较的对象以及编辑距离的值 </li>
</ul></li>
<li>把得到的结果写成 HTML 文件保存在本地</li>
<li>支持自定义参数调用，例如可以在命令行中输入文件名</li>
</ol>

<h2 id="toc_2">Hello World</h2>

<p>配置好了环境，就可以开始这次的任务了，但是开始之前，万变不离其宗，先要来一发 hello world。步骤如下</p>

<ol>
<li>新建一个文件夹</li>
<li>文件夹里新建一个名为 <code>hello.js</code> 的文件</li>
</ol>

<p>文件内容</p>

<pre><code class="language-javascript">console.log(&#39;Hello World, this is wdx&#39;);
</code></pre>

<p>用命令行进入刚才新建的文件夹，然后 <code>node hello.js</code>，可以看到输出了 <code>Hello World, this is wdx</code>，于是第一步就完成了。</p>

<h2 id="toc_3">一：读取文件</h2>

<p>知道了基本的执行操作，我们可以开始读入指定的 txt 文件，下载好<a href="http://www.gutenberg.org/cache/epub/45/pg45.txt">文件</a> 并放在同一个文件夹里，就可以利用 node.js 自带的库来进行操作了。</p>

<p>然后我们新建另外一个文件 <code>parser.js</code>，具体的操作请参看注释，这里用了一些变量名方便以后拓展，也有把函数作为参数传给另外的函数，这个是函数式编程的做法，在这里不展开。</p>

<pre><code class="language-javascript">// load file system module
var fs = require(&#39;fs&#39;);

var filename = &#39;pg45.txt&#39;;

console.log(&#39;loading content from &#39; + filename);

// read the contents of the file into memory
fs.readFile(filename, function (err, buffer) {
    // If an error occurred, throwing it will
    // display the exception and end our app
    if (err) throw err;

    // buffer is a Buffer, convert to string
    var text = buffer.toString();
    console.log(&#39;loading done&#39;);
});
</code></pre>

<p>载入之后我们就可以对内容进行操作了</p>

<h2 id="toc_4">二：数据统计</h2>

<h3 id="toc_5">行数/词数/词频</h3>

<p>完成了上一节，我们已经拿到了文本的内容，可以开始具体操作了。直接在刚才的文件后面继续添加代码，统计单词数量，行数，以及每个单词出现的次数。</p>

<pre><code class="language-javascript">console.log(&#39;start processing content&#39;);

// the stats variable
var linecount = 0;
var wordcount = 0;

// get line count
var lines = text.split(&#39;\n&#39;);
linecount = lines.length;

// get words count and their number of appearance
var index = {};
lines.forEach(function(line){
   var words = line
               .replace(/[.,?!;()&quot;-]/g, &quot; &quot;)
               .replace(/\s+/g, &quot; &quot;)
               .toLowerCase()
               .split(&quot; &quot;);
   // count words
   wordcount += words.length;
   // build index dictionary
   words.forEach(function (word) {
       if (word != &#39;&#39;){
           if (!(index.hasOwnProperty(word))){
               index[word] = 0;
           }
           index[word]++;
       }
   });
});

// change dict to array for sort
var indexarr = [];
var i = 0
for (var key of Object.keys(index).sort()){
   indexarr[i] = [key, index[key]];
   i += 1;
}

// sort the array
indexarr = indexarr.sort(function(x,y){
   return y[1] - x[1];
});

console.log(&#39;processing content done&#39;);
console.log(&#39;--------statistics--------&#39;);

console.log(&#39;Line Count: &#39; + linecount);
console.log(&#39;Word Count: &#39; + wordcount);
for (var j = 0; j &lt; 10; j++){
   console.log(indexarr[j]);
}
</code></pre>

<h3 id="toc_6">Trigram 统计</h3>

<p>Triagram 的定义可以从 <a href="https://en.wikipedia.org/wiki/Trigram">wiki</a> 找到，其实就是遍历一次所有的单词，三个三个一组，然后统计频率，其实逻辑和前面统计词频是一样的。所以思路是增加一个存所有单词的数组，然后遍历生成字典，然后字典转数组进行排序找到前十一个，这样就可以显示前十个，并且计算第一个和后面十个的编辑距离。</p>

<p>我们先修改一下之前统计词频的代码</p>

<pre><code class="language-javascript">// get words count and their number of appearance
var index = {};
// save each word to an array
var wordarr = [];
// save the trigram to an dictionary
var trigrams = {};

lines.forEach(function(line){
   var words = line
               .replace(/[.,?!;()&quot;-]/g, &quot; &quot;)
               .replace(/\s+/g, &quot; &quot;)
               .toLowerCase()
               .split(&quot; &quot;);
   // count words
   wordcount += words.length;
   // build index dictionary
   words.forEach(function (word) {
       if (word != &#39;&#39;){
           wordarr.push(word);
           if (!(index.hasOwnProperty(word))){
               index[word] = 0;
           }
           index[word]++;
       }
   });
});
</code></pre>

<p>接下来就主要处理这个 <code>wordarr</code> 数组了，利用 <code>slice()</code> 和 <code>join()</code> 的功能就可以很方便地实现：</p>

<pre><code class="language-javascript">// get trigram
for (var j = 0; j &lt; wordarr.length-3; j++){
   var temp = wordarr.slice(j, j+3).join(&#39; &#39;);
   if (!(trigrams.hasOwnProperty(temp))){
       trigrams[temp] = 0;
   }
   trigrams[temp]++;
}

// change dict to array for sort
var trigramsarr = [];
var i = 0
for (var key of Object.keys(trigrams).sort()){
   trigramsarr[i] = [key, trigrams[key]];
   i += 1;
}

// sort the array
trigramsarr = trigramsarr.sort(function(x,y){
   return y[1] - x[1];
});

// Get Top 11 trigrams
trigramtop11 = trigramsarr.slice(0,11);
</code></pre>

<p>再运行一下，就可以看到结果没有问题了，就剩最后一个问题，编辑距离</p>

<h3 id="toc_7">编辑距离</h3>

<p>编辑距离又叫 levenshtein 距离，是一种比较两个字符串相似程度的算法，具体的原理不赘述，利用动态规划就可以解决，我们这里写一个函数方便调用。</p>

<pre><code class="language-javascript">function levenshtein(a, b) {
    var al = a.length + 1;
    var bl = b.length + 1;
    var result = [];
    var temp = 0;
    // 创建一个二维数组
    for (var i = 0; i &lt; al; result[i] = [i++]) {}
    for (var i = 0; i &lt; bl; result[0][i] = i++) {}      
    for (i = 1; i &lt; al; i++) {
        for (var j = 1; j &lt; bl; j++) {
            // 判断最上方和最左方数字是否相等
            temp = a[i - 1] == b[j - 1] ? 0 : 1;
            // result[i - 1][j] + 1 左方数字
            // result[i][j - 1] + 1 上方数字
            // result[i - 1][j - 1] + temp 左上方数字
            result[i][j] = Math.min(result[i - 1][j] + 1, result[i][j - 1] + 1, result[i - 1][j - 1] + temp);
        }
    }
    return result[i-1][j-1];
}
</code></pre>

<p>然后只要在代码中调用这个函数即可</p>

<pre><code class="language-javascript">// Calculate edit distance and sort by distance value
// create an array to save the result
var resultstr = [];
for (var j = 1; j &lt; 11; j++){
   var dis = levenshtein(trigramtop11[0][0], trigramtop11[j][0]);
   var str = &quot;[&quot; + trigramtop11[0][0] + &quot;] vs [&quot; + trigramtop11[j][0] + &quot;]: &quot;;
   resultstr.push([str, dis]);
}
resultstr.sort(function(x, y){
   return y[1] - x[1];
});
</code></pre>

<p>这样一来，第二步也就完成了</p>

<h2 id="toc_8">三：输出 HTML</h2>

<p>写入文件我们同样使用 fs 模块，思路是我们先把要展示的内容存到一个 string 中，然后一次写入到 html 文件里，就算完成。具体代码比较简单，这也是之前为什么我要把所有的计算结果都换存起来的原因，方便写入。注意 HTML 输出的格式即可，代码如下：</p>

<pre><code class="language-javascript">console.log(&#39;Creating HTML content&#39;);

var htmlcontent = &#39;&lt;html&gt;&lt;head&gt;&lt;title&gt;&#39; + filename + &#39; Analysis Result&lt;/title&gt;&lt;head&gt;&#39;;
htmlcontent += &#39;&lt;body&gt;&lt;h1&gt;&#39; + filename + &#39; Analysis Result&lt;/h1&gt;&#39;;
htmlcontent += &#39;&lt;h2&gt;Line Count: &#39; + linecount + &#39;&lt;/h2&gt;&#39;;
htmlcontent += &#39;&lt;h2&gt;Word Count: &#39; + wordcount + &#39;&lt;/h2&gt;&#39;;
htmlcontent += &#39;&lt;h2&gt;Trigram Frequency (Top 10)&lt;/h2&gt;&lt;ol&gt;&#39;;
for (var j = 0; j &lt; 10; j++){
   htmlcontent += &#39;&lt;li&gt;&#39; + trigramtop11[j] + &#39;&lt;/li&gt;&#39;;
}
htmlcontent += &#39;&lt;/ol&gt;&lt;h2&gt;Trigram Edit Distance&lt;/h2&gt;&lt;ol&gt;&#39;;
for (var j = 0; j &lt; 10; j++){
   htmlcontent += &#39;&lt;li&gt;&#39; + resultstr[j] + &#39;&lt;/li&gt;&#39;;
}
htmlcontent += &#39;&lt;/ol&gt;&lt;h2&gt;Word Frequency&lt;/h2&gt;&lt;ul&gt;&#39;;
for (var j = 0; j &lt; indexarr.length; j++){
   htmlcontent += &#39;&lt;li&gt;&#39; + indexarr[j] + &#39;&lt;/li&gt;&#39;;
}
htmlcontent += &#39;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;&#39;;


console.log(&#39;&#39;)
console.log(&#39;Generating HTML file&#39;);
var filenamearr = filename.split(&#39;.&#39;);

fs.writeFile(filenamearr[0] + &#39;-result.html&#39;, htmlcontent, function(err){
   if (err){
       return console.error(err);
   }
   console.log(&#39;Generation Success&#39;);
   console.log(&#39;Filename: &#39; + filenamearr[0] + &#39;-result.hmtl&#39;);
   console.log(&#39;---------------------&#39;);
   console.log(&#39;All Job Done&#39;);
});
</code></pre>

<h2 id="toc_9">四：传入参数</h2>

<p>现在我们读入的内容是写死在代码里的，如果我们需要更灵活，从命令行传入参数的话，还需要对代码做一些改动。现在我们调用 <code>parser.js</code> 的方式是使用 <code>node parser.js</code>，现在需要实现用 <code>node parser.js pg45.txt</code> 这样的方式，可以把代码改为：</p>

<pre><code class="language-javascript">var filename = process.argv[2];

if (filename == undefined){
    console.log(&#39;No input argument, use default file&#39;);
    filename = &#39;pg45.txt&#39;;
}
</code></pre>

<p>这里也做了一些错误处理以防用户没有输入第二个参数，如果命令是 <code>node parser.js pg45.txt</code>，那么参数实际是 <code>[&#39;node&#39;, &#39;/path/to/parser&#39;, &#39;pg45.txt&#39;]</code></p>

<h2 id="toc_10">总结</h2>

<p>至此，所有的任务就已经完成了，具体的代码可以在<a href="https://github.com/wdxtub/11601-summary-stat-nodejs">这里</a>找到，这个教程不涉及网络，也只使用了 fs 一个模块，但是对于熟悉 javascript 和 nodejs，是一个很好的练习。</p>

<h2 id="toc_11">参考资料</h2>

<ul>
<li><a href="http://www.ruanyifeng.com/blog/2015/05/command-line-with-node.html">Node.js 命令行程序开发教程</a></li>
<li><a href="http://www.html-js.com/article/A-day-to-learn-JavaScript-create-commandline-tools-with-Nodejs">用Node.js创建命令行工具</a></li>
</ul>


</div>

<br /><br />
<hr />

<div class="row clearfix">
  <div class="large-6 columns">
	<div class="text-left" style="padding:15px 0px;">
		
	        <a href="14520476779491.html"  title="Previous Post: 网络协议指南">&laquo; 网络协议指南</a>
	    
	</div>
  </div>
  <div class="large-6 columns">
	<div class="text-right" style="padding:15px 0px;">
		
	        <a href="14520476779406.html" 
	        title="Next Post: Flask Study Note">Flask Study Note &raquo;</a>
	    
	</div>
  </div>
</div>

<div class="row">
<div style="padding:0px 0.93em;" class="share-comments">

</div>
</div>
<script type="text/javascript">
	$(function(){
		var currentURL = '14520476779456.html';
		$('#side-nav a').each(function(){
			if($(this).attr('href') == currentURL){
				$(this).parent().addClass('active');
			}
		});
	});
</script>  
</div></div>


<div class="page-bottom">
  <div class="row">
  <hr />
  <div class="small-9 columns">
  <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
  <div class="small-3 columns">
  <p class="copyright text-right"><a href="#header">TOP</a></p>
  </div>
   
  </div>
</div>

        </section>
      </div>
    </div>
    
    
    <script src="asset/js/foundation.min.js"></script>
    <script src="asset/js/foundation/foundation.offcanvas.js"></script>
    <script>
      $(document).foundation();

     
    </script>
    
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  </body>
</html>
